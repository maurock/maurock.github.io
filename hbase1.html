<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>CODE</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,500,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Raleway:700,200,400,300" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:700,200,400,300" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <!-- Plugin CSS -->
    <link href="vendor/magnific-popup/magnific-popup.css" rel="stylesheet" type="text/css">

    <!-- Custom styles for this template -->
    <link href="css/freelancer.css" rel="stylesheet">

</head>

<body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg bg-secondary fixed-top text-uppercase" id="mainNav">
        <div class="container">
            <a class="navbar-brand js-scroll-trigger" style="font-family: Raleway; font-size: 20px;" href="https://vegaoscar.000webhostapp.com/index.html">Mauro Comi</a>
            <button class="navbar-toggler navbar-toggler-right text-uppercase bg-primary text-white rounded" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                Menu
                <i class="fa fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item mx-0 mx-lg-1">
                        <a class="nav-link py-3 px-0 px-lg-3 rounded" href="index.html#papers" style="color: #fff !important">Papers</a>
                    </li>
                    <li class="nav-item mx-0 mx-lg-1">
                        <a class="nav-link py-3 px-0 px-lg-3 rounded" href="index.html#portfolio" style="color: #fff !important">My Projects</a>
                    </li>
                    <li class="nav-item mx-0 mx-lg-1">
                        <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="index.html#about" style="color: #fff !important">About me</a>
                    </li>
                    <li class="nav-item mx-0 mx-lg-1">
                        <a class="nav-link py-3 px-0 px-lg-3 rounded js-scroll-trigger" href="index.html#contact" style="color: #fff !important">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    <!-- Code -->
    <section class="code" id="prediction">
        <div class="container">
            <h2 class="text-center text-uppercase text-secondary mb-0" style="margin-top: 50px;">TPC-C Benchmark</h2>
            <br><br>

            <div class="snippet">
                <h3><b>Introduction</b></h3>For this Project I used some of the TPC-C benchmark tables. The TPC-C benchmark simulates the activity of any company that must manage, sell, and distribute products or services. A full description of the database can be found here: <a href="http://www.tpc.org/tpc_documents_current_versions/pdf/tpc-c_v5.11.0.pdf">http://www.tpc.org/tpc_documents_current_versions/pdf/tpc-c_v5.11.0.pdf</a>. The goal of this project is to develop a Java program using HBase implementing four different queries:
                <ul>
                    <li><b>Query 1:</b> List the customers with an order from a given warehouse and district during time interval specified by a START_DATE (included) and END_DATE (excluded).</li>
                    <li><b>Query 2:</b> Insert/update (up to 6 times) the discount for a given customer, warehouse and district.</li>
                    <li><b>Query 3: </b>Show the latest 4 discounts for a given customer, warehouse and district.</li>
                    <li><b>Query 4: </b>List all the customers from a given list of districts in a specified warehouse.</li>
                </ul>

                The App was developed using <b>Oracle Java 8, Hbase</b> and deployed using <b>Ubuntu</b>.
            </div>

            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.conf.Configuration</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.hbase.*</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.hbase.client.*</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.hbase.filter.CompareFilter</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.hbase.filter.FilterList</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.hbase.filter.SingleColumnValueFilter</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">org.apache.hadoop.hbase.util.Bytes</span><span style="color: #333333">;</span>

<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.io.*</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.ArrayList</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.Arrays</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.util.List</span><span style="color: #333333">;</span>
</pre>
            </div>


            <div class="snippet">Initially I created the name of the tables, and converted them in Bytes. Then, I created the object Configuration, set the server and the port, and finally created the HBaseAdmin. This last object is responsible for creating the tables, or connecting them in case they already exist.</div>




            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%">    <span style="color: #008800; font-weight: bold">private</span> Configuration config<span style="color: #333333">;</span>
    <span style="color: #008800; font-weight: bold">private</span> HBaseAdmin hBaseAdmin<span style="color: #333333">;</span>

    <span style="color: #888888">//Assign names of Column Families</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> CF <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;CF&quot;</span><span style="color: #333333">);</span>


    <span style="color: #888888">//Assign Table Names</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_A <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Warehouse&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_B <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;District&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_C <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Item&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_D <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;New_order&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_E <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Orders&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_F <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;History&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_G <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Customer&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_H <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Stock&quot;</span><span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_I <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Order_line&quot;</span><span style="color: #333333">);</span>

    <span style="color: #888888">/**</span>
<span style="color: #888888">     * The Constructor. Establishes the connection with HBase.</span>
<span style="color: #888888">     * @param zkHost</span>
<span style="color: #888888">     * @throws IOException</span>
<span style="color: #888888">     */</span>
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #0066BB; font-weight: bold">HBaseTPCC</span><span style="color: #333333">(</span>String zkHost<span style="color: #333333">)</span> <span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>
        config <span style="color: #333333">=</span> HBaseConfiguration<span style="color: #333333">.</span><span style="color: #0000CC">create</span><span style="color: #333333">();</span>
        config<span style="color: #333333">.</span><span style="color: #0000CC">set</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;hbase.zookeeper.quorum&quot;</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;localhost&quot;</span><span style="color: #333333">);</span>
        config<span style="color: #333333">.</span><span style="color: #0000CC">set</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;hbase.zookeeper.property.clientPort&quot;</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;2181&quot;</span><span style="color: #333333">);</span>
        HBaseConfiguration<span style="color: #333333">.</span><span style="color: #0000CC">addHbaseResources</span><span style="color: #333333">(</span>config<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HBaseAdmin<span style="color: #333333">(</span>config<span style="color: #333333">);</span>
    <span style="color: #333333">}</span>
</pre>
            </div>


            <div class="snippet">
                <h3><b>Create tables</b></h3>The first function creates the tables in the server. These tables are generated according to the TPC-C schema. The Column Family is set as 6 versions, and this features will be used for Query 3.

            </div>
            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">createTPCCTables</span><span style="color: #333333">()</span> <span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>

        HTableDescriptor table_A <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_A<span style="color: #333333">));</span>
        HTableDescriptor table_B <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_B<span style="color: #333333">));</span>
        HTableDescriptor table_C <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_C<span style="color: #333333">));</span>
        HTableDescriptor table_D <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_D<span style="color: #333333">));</span>
        HTableDescriptor table_E <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_E<span style="color: #333333">));</span>
        HTableDescriptor table_F <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_F<span style="color: #333333">));</span>
        HTableDescriptor table_G <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_G<span style="color: #333333">));</span>
        HTableDescriptor table_H <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_H<span style="color: #333333">));</span>
        HTableDescriptor table_I <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTableDescriptor<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_I<span style="color: #333333">));</span>


        HColumnDescriptor A <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HColumnDescriptor<span style="color: #333333">(</span>CF<span style="color: #333333">);</span>
        A<span style="color: #333333">.</span><span style="color: #0000CC">setMaxVersions</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">6</span><span style="color: #333333">);</span>


        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_A<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_A<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_A<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_B<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_B<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_B<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_C<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_C<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_C<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_D<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_D<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_D<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_E<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_E<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_E<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_F<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_F<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_F<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_G<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_G<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_G<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>

        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_H<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_H<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_H<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">tableExists</span><span style="color: #333333">(</span>table_I<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">())){</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">disableTable</span><span style="color: #333333">(</span>table_I<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
            hBaseAdmin<span style="color: #333333">.</span><span style="color: #0000CC">deleteTable</span><span style="color: #333333">(</span>table_I<span style="color: #333333">.</span><span style="color: #0000CC">getName</span><span style="color: #333333">());</span>
        <span style="color: #333333">}</span>


        table_A<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_B<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_C<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_D<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_E<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_F<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_G<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_H<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>
        table_I<span style="color: #333333">.</span><span style="color: #0000CC">addFamily</span><span style="color: #333333">(</span>A<span style="color: #333333">);</span>


        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_A<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_B<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_C<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_D<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_E<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_F<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_G<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_H<span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">this</span><span style="color: #333333">.</span><span style="color: #0000CC">hBaseAdmin</span><span style="color: #333333">.</span><span style="color: #0000CC">createTable</span><span style="color: #333333">(</span>table_I<span style="color: #333333">);</span>
    <span style="color: #333333">}</span>
</pre>
            </div>





            <div class="snippet">
                <h3><b>Load tables</b></h3>Once the tables are created, I first create connections to them using the HConnectionManager. Then, I loaded the content of the .csv files inside them. The function <i>colName(i)</i> receives as input a number from 0 to 8 (representing the 9 tables), and returns an array of String containing all the variables presented in each table.
            </div>


            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%"> <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">loadTables</span><span style="color: #333333">(</span>String folder<span style="color: #333333">)</span><span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>

        HConnection conn <span style="color: #333333">=</span> HConnectionManager<span style="color: #333333">.</span><span style="color: #0000CC">createConnection</span><span style="color: #333333">(</span>config<span style="color: #333333">);</span>

        <span style="color: #888888">//Assign names of Column Families</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> CF <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;CF&quot;</span><span style="color: #333333">);</span>

        <span style="color: #888888">//Assign Table Names</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_A <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Warehouse&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_B <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;District&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_C <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Item&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_D <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;New_order&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_E <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Orders&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_F <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;History&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_G <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Customer&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_H <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Stock&quot;</span><span style="color: #333333">);</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> TABLE_I <span style="color: #333333">=</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Order_line&quot;</span><span style="color: #333333">);</span>

        HTable table_A <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_A<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_B <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_B<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_C <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_C<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_D <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_D<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_E <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_E<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_F <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_F<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_G <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_G<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_H <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_H<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>
        HTable table_I <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_I<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>

        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 1&quot;</span><span style="color: #333333">);</span>
        String currentLine <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
        BufferedReader br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/warehouse.csv&quot;</span><span style="color: #333333">));</span>
        <span style="color: #333399; font-weight: bold">int</span> cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>            
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_A<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>

        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 2&quot;</span><span style="color: #333333">);</span>
        currentLine <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/district.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_B<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>


        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 3&quot;</span><span style="color: #333333">);</span>
        currentLine <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">;</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/item.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_C<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>


        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 4&quot;</span><span style="color: #333333">);</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/new_order.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">3</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_D<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>


        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 5&quot;</span><span style="color: #333333">);</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/orders.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>            
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_E<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>

        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 6&quot;</span><span style="color: #333333">);</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/history.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">3</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_F<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>


        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 7&quot;</span><span style="color: #333333">);</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/customer.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">6</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_G<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>


        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 8&quot;</span><span style="color: #333333">);</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/stock.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">7</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_H<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>

        System<span style="color: #333333">.</span><span style="color: #0000CC">out</span><span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Insert 9&quot;</span><span style="color: #333333">);</span>
        br <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> BufferedReader<span style="color: #333333">(</span>
                <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">FileReader</span><span style="color: #333333">(</span>folder <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;/order_line.csv&quot;</span><span style="color: #333333">));</span>
        cont <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>currentLine <span style="color: #333333">=</span> br<span style="color: #333333">.</span><span style="color: #0000CC">readLine</span><span style="color: #333333">())</span> <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            String<span style="color: #333333">[]</span> line <span style="color: #333333">=</span> currentLine<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
            <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> poskey1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">3</span><span style="color: #333333">};</span>
            Put p <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span>line<span style="color: #333333">,</span> poskey1<span style="color: #333333">));</span>
            cont <span style="color: #333333">=</span> cont<span style="color: #333333">+</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
            <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> <span style="color: #333333">(</span>line<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">);</span> i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
                p<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>colName<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">8</span><span style="color: #333333">)[</span>i<span style="color: #333333">]),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>line<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            <span style="color: #333333">}</span>
            table_I<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>p<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>
</pre>
            </div>


            <div class="snippet">
                <h5><b>Query 1</b></h5>
            </div>


            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%">    <span style="color: #008800; font-weight: bold">public</span> List<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;</span> <span style="color: #0066BB; font-weight: bold">query1</span><span style="color: #333333">(</span>String warehouseId<span style="color: #333333">,</span> String districtId<span style="color: #333333">,</span> String startDate<span style="color: #333333">,</span> String endDate<span style="color: #333333">)</span> <span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>
        HConnection conn <span style="color: #333333">=</span> HConnectionManager<span style="color: #333333">.</span><span style="color: #0000CC">createConnection</span><span style="color: #333333">(</span>config<span style="color: #333333">);</span>
        HTable table_E <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_E<span style="color: #333333">),</span>conn<span style="color: #333333">);</span>

        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> startKey <span style="color: #333333">=</span> getKey<span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> String<span style="color: #333333">[]</span> <span style="color: #333333">{</span>warehouseId<span style="color: #333333">,</span>districtId<span style="color: #333333">,</span> startDate<span style="color: #333333">},</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> <span style="color: #333333">{</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">});</span>
        <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> endKey <span style="color: #333333">=</span>  getKey<span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> String<span style="color: #333333">[]</span> <span style="color: #333333">{</span>warehouseId<span style="color: #333333">,</span>districtId<span style="color: #333333">,</span> endDate<span style="color: #333333">},</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> <span style="color: #333333">{</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">});</span>

        Scan scan <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Scan<span style="color: #333333">(</span>startKey<span style="color: #333333">,</span>endKey<span style="color: #333333">);</span>

        ResultScanner rs <span style="color: #333333">=</span> table_E<span style="color: #333333">.</span><span style="color: #0000CC">getScanner</span><span style="color: #333333">(</span>scan<span style="color: #333333">);</span>
        Result res <span style="color: #333333">=</span> rs<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>

        ArrayList<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;</span> CustomerID <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;&gt;();</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>res<span style="color: #333333">!=</span><span style="color: #008800; font-weight: bold">null</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>res<span style="color: #333333">.</span><span style="color: #0000CC">isEmpty</span><span style="color: #333333">()){</span>
            CustomerID<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">(</span>res<span style="color: #333333">.</span><span style="color: #0000CC">getValue</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;O_C_ID&quot;</span><span style="color: #333333">))));</span>
            res <span style="color: #333333">=</span> rs<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> CustomerID<span style="color: #333333">;</span>

    <span style="color: #333333">}</span>
</pre>
            </div>



            <div class="snippet">
                <h5><b>Query 2</b></h5>
            </div>

            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%">    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">query2</span><span style="color: #333333">(</span>String warehouseId<span style="color: #333333">,</span> String districtId<span style="color: #333333">,</span> String customerId<span style="color: #333333">,</span> String<span style="color: #333333">[]</span> discounts<span style="color: #333333">)</span> <span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>
        HConnection conn <span style="color: #333333">=</span> HConnectionManager<span style="color: #333333">.</span><span style="color: #0000CC">createConnection</span><span style="color: #333333">(</span>config<span style="color: #333333">);</span>
        HTable table_G <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_G<span style="color: #333333">),</span>conn<span style="color: #333333">);</span>

        <span style="color: #008800; font-weight: bold">for</span> <span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i<span style="color: #333333">&lt;</span>discounts<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> i<span style="color: #333333">++){</span>
            Put put <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Put<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> String<span style="color: #333333">[]</span> <span style="color: #333333">{</span>warehouseId<span style="color: #333333">,</span>districtId<span style="color: #333333">,</span>customerId<span style="color: #333333">},</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]</span> <span style="color: #333333">{</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">}));</span>
            put<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;C_DISCOUNT&quot;</span><span style="color: #333333">),</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>discounts<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            table_G<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span>put<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>
    <span style="color: #333333">}</span>
</pre>
            </div>


            <div class="snippet">
                <h5><b>Query 3</b></h5>
            </div>


            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%">    <span style="color: #008800; font-weight: bold">public</span> String<span style="color: #333333">[]</span> <span style="color: #0066BB; font-weight: bold">query3</span><span style="color: #333333">(</span>String warehouseId<span style="color: #333333">,</span> String districtId<span style="color: #333333">,</span> String customerId<span style="color: #333333">)</span> <span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>
        HConnection conn <span style="color: #333333">=</span> HConnectionManager<span style="color: #333333">.</span><span style="color: #0000CC">createConnection</span><span style="color: #333333">(</span>config<span style="color: #333333">);</span>
        HTable table_G <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_G<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>

        Get get <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Get<span style="color: #333333">(</span>getKey<span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> String<span style="color: #333333">[]{</span>warehouseId<span style="color: #333333">,</span> districtId<span style="color: #333333">,</span> customerId<span style="color: #333333">},</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">[]{</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">}));</span>
        get<span style="color: #333333">.</span><span style="color: #0000CC">addColumn</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;C_DISCOUNT&quot;</span><span style="color: #333333">));</span>
        get<span style="color: #333333">.</span><span style="color: #0000CC">setMaxVersions</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">);</span>
        Result result <span style="color: #333333">=</span> table_G<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span>get<span style="color: #333333">);</span>
        ArrayList<span style="color: #333333">&lt;</span>String<span style="color: #333333">&gt;</span> Discount_ID <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;&gt;();</span>
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>result <span style="color: #333333">!=</span> <span style="color: #008800; font-weight: bold">null</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>result<span style="color: #333333">.</span><span style="color: #0000CC">isEmpty</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
            CellScanner scanner <span style="color: #333333">=</span> result<span style="color: #333333">.</span><span style="color: #0000CC">cellScanner</span><span style="color: #333333">();</span>
            <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>scanner<span style="color: #333333">.</span><span style="color: #0000CC">advance</span><span style="color: #333333">())</span> <span style="color: #333333">{</span>
                Cell cell <span style="color: #333333">=</span> scanner<span style="color: #333333">.</span><span style="color: #0000CC">current</span><span style="color: #333333">();</span>
                <span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> value <span style="color: #333333">=</span> CellUtil<span style="color: #333333">.</span><span style="color: #0000CC">cloneValue</span><span style="color: #333333">(</span>cell<span style="color: #333333">);</span>
                Discount_ID<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">(</span>value<span style="color: #333333">));</span>
            <span style="color: #333333">}</span>

        <span style="color: #333333">}</span>
        String<span style="color: #333333">[]</span> array <span style="color: #333333">=</span> Discount_ID<span style="color: #333333">.</span><span style="color: #0000CC">toArray</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> String<span style="color: #333333">[</span>Discount_ID<span style="color: #333333">.</span><span style="color: #0000CC">size</span><span style="color: #333333">()]);</span>
        <span style="color: #008800; font-weight: bold">return</span> array<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>
</pre>
            </div>

            <div class="snippet">
                <h5><b>Query 4</b></h5>
            </div>

            <!-- HTML generated using hilite.me -->
            <div style="background: #ffffff; overflow:auto;width:auto;background: #ffffff;overflow:auto;width:auto;border: solid #c1c1c1;border-width: .05em .05em .05em .05em;border-radius: 0.5em;padding: 0.8em .6em;">
                <pre style="margin: 0; line-height: 125%">    <span style="color: #008800; font-weight: bold">public</span> List<span style="color: #333333">&lt;</span>Integer<span style="color: #333333">&gt;</span> <span style="color: #0066BB; font-weight: bold">query4</span><span style="color: #333333">(</span>String warehouseId<span style="color: #333333">,</span> String<span style="color: #333333">[]</span> districtIds<span style="color: #333333">)</span> <span style="color: #008800; font-weight: bold">throws</span> IOException <span style="color: #333333">{</span>
        HConnection conn <span style="color: #333333">=</span> HConnectionManager<span style="color: #333333">.</span><span style="color: #0000CC">createConnection</span><span style="color: #333333">(</span>config<span style="color: #333333">);</span>
        HTable table_G <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> HTable<span style="color: #333333">(</span>TableName<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>TABLE_G<span style="color: #333333">),</span> conn<span style="color: #333333">);</span>

        <span style="color: #333399; font-weight: bold">int</span> endKey2 <span style="color: #333333">=</span>  Integer<span style="color: #333333">.</span><span style="color: #0000CC">parseInt</span><span style="color: #333333">(</span>warehouseId<span style="color: #333333">);</span>
        endKey2 <span style="color: #333333">=</span> endKey2 <span style="color: #333333">+</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">;</span>
        String endKey <span style="color: #333333">=</span> Integer<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">(</span>endKey2<span style="color: #333333">);</span>
        Scan scan <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Scan<span style="color: #333333">(</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>warehouseId<span style="color: #333333">),</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>endKey<span style="color: #333333">));</span>

        FilterList list <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> FilterList<span style="color: #333333">(</span>FilterList<span style="color: #333333">.</span><span style="color: #0000CC">Operator</span><span style="color: #333333">.</span><span style="color: #0000CC">MUST_PASS_ONE</span><span style="color: #333333">);</span>
        <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i<span style="color: #333333">=</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span>i <span style="color: #333333">&lt;</span> districtIds<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span>i<span style="color: #333333">++)</span> <span style="color: #333333">{</span>
            SingleColumnValueFilter filter1 <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> SingleColumnValueFilter<span style="color: #333333">(</span>
                    CF<span style="color: #333333">,</span> Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;C_D_ID&quot;</span><span style="color: #333333">)</span> <span style="color: #333333">,</span>
                    CompareFilter<span style="color: #333333">.</span><span style="color: #0000CC">CompareOp</span><span style="color: #333333">.</span><span style="color: #0000CC">EQUAL</span><span style="color: #333333">,</span>
                    Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span>districtIds<span style="color: #333333">[</span>i<span style="color: #333333">]));</span>
            list<span style="color: #333333">.</span><span style="color: #0000CC">addFilter</span><span style="color: #333333">(</span>filter1<span style="color: #333333">);</span>
        <span style="color: #333333">}</span>

        scan<span style="color: #333333">.</span><span style="color: #0000CC">setFilter</span><span style="color: #333333">(</span>list<span style="color: #333333">);</span>

        ResultScanner rs <span style="color: #333333">=</span> table_G<span style="color: #333333">.</span><span style="color: #0000CC">getScanner</span><span style="color: #333333">(</span>scan<span style="color: #333333">);</span>
        Result res <span style="color: #333333">=</span> rs<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>

        ArrayList<span style="color: #333333">&lt;</span>Integer<span style="color: #333333">&gt;</span> CustomerID <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;&gt;();</span>
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">(</span>res<span style="color: #333333">!=</span><span style="color: #008800; font-weight: bold">null</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">!</span>res<span style="color: #333333">.</span><span style="color: #0000CC">isEmpty</span><span style="color: #333333">()){</span>
            CustomerID<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span>Integer<span style="color: #333333">.</span><span style="color: #0000CC">parseInt</span><span style="color: #333333">(</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">(</span>res<span style="color: #333333">.</span><span style="color: #0000CC">getValue</span><span style="color: #333333">(</span>CF<span style="color: #333333">,</span>Bytes<span style="color: #333333">.</span><span style="color: #0000CC">toBytes</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;C_ID&quot;</span><span style="color: #333333">)))));</span>
            res <span style="color: #333333">=</span> rs<span style="color: #333333">.</span><span style="color: #0000CC">next</span><span style="color: #333333">();</span>
        <span style="color: #333333">}</span>
        <span style="color: #008800; font-weight: bold">return</span> CustomerID<span style="color: #333333">;</span>
    <span style="color: #333333">}</span>
</pre>
            </div>



        </div>
    </section>

    <!-- Footer  /-->
    <div class="copyright py-4 text-center text-white">
        <div class="container">
            <small>Made with <svg class="heart" viewBox="0 0 32 29.6">
                    <path d="M23.6,0c-3.4,0-6.3,2.7-7.6,5.6C14.7,2.7,11.8,0,8.4,0C3.8,0,0,3.8,0,8.4c0,9.4,9.5,11.9,16,21.2c6.1-9.3,16-12.1,16-21.2C32,3.8,28.2,0,23.6,0z" />
                </svg> by Mauro Comi</small>
        </div>
    </div>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-to-top d-lg-none position-fixed ">
        <a class="js-scroll-trigger d-block text-center text-white rounded" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="vendor/magnific-popup/jquery.magnific-popup.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/freelancer.min.js"></script>

</body>

</html>
